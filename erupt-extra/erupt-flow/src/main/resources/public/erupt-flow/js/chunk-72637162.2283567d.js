(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-72637162"],{"1f4e":function(e,t,i){"use strict";i("f2cb")},"2b36":function(e,t,i){"use strict";var n=function(){var e=this,t=e._self._c;return t("el-form",{ref:"form",staticClass:"process-form",attrs:{"label-position":"top",rules:e.rules,model:e._value}},e._l(e.forms,(function(i,n){return"SpanLayout"!==i.name&&"Description"!==i.name?t("el-form-item",{key:i.name+n,attrs:{prop:i.id,label:i.title}},[t("form-design-render",{ref:"sub-item_"+i.id,refInFor:!0,attrs:{mode:e.mode,formDisable:e.formDisable,config:i},on:{change:e.change},model:{value:e._value[i.id],callback:function(t){e.$set(e._value,i.id,t)},expression:"_value[item.id]"}})],1):t("form-design-render",{ref:"span-layout",attrs:{mode:e.mode,formDisable:e.formDisable,config:i},model:{value:e._value,callback:function(t){e._value=t},expression:"_value"}})})),1)},a=[],s=i("d16b"),r={name:"FormRender",components:{FormDesignRender:s["a"]},props:{forms:{type:Array,default:()=>[]},value:{type:Object,default:()=>({})},mode:{type:String,default:"PC"},formDisable:{type:Boolean,default:!1}},data(){return{rules:{}}},created(){this.loadFormConfig(this.forms)},computed:{_value:{get(){return this.value},set(e){this.$emit("input",e)}}},watch:{},methods:{validate(e){let t=!0;this.$refs.form.validate(i=>{if(t=i,i)for(let e=0;e<this.forms.length;e++)if("TableList"===this.forms[e].name){let i=this.$refs["sub-item_"+this.forms[e].id];if(i&&Array.isArray(i)&&i.length>0&&(i[0].validate(e=>{t=e}),!t))break}e(t)})},loadFormConfig(e){e.forEach(e=>{"SpanLayout"===e.name?this.loadFormConfig(e.props.items):(this.$set(this._value,e.id,this.value[e.id]),e.props.required&&this.$set(this.rules,e.id,[{type:"Array"===e.valueType?"array":void 0,required:!0,message:"请填写"+e.title,trigger:"blur"}]))})},change(e,t){this.$emit("change",e,t)}}},l=r,o=(i("9257"),i("2877")),c=Object(o["a"])(l,n,a,!1,null,"4bde07c6",null);t["a"]=c.exports},"644f":function(e,t,i){"use strict";i.d(t,"g",(function(){return a})),i.d(t,"e",(function(){return s})),i.d(t,"a",(function(){return r})),i.d(t,"f",(function(){return l})),i.d(t,"i",(function(){return o})),i.d(t,"h",(function(){return c})),i.d(t,"d",(function(){return d})),i.d(t,"b",(function(){return u})),i.d(t,"c",(function(){return m}));var n=i("0c6d");function a(e,t){return Object(n["a"])({url:"/process/start/form/"+e,method:"post",data:t})}function s(e){return Object(n["a"])({url:"/task/mine",method:"get",params:e})}function r(e,t){return Object(n["a"])({url:"/task/complete/"+e,method:"post",params:{remarks:t}})}function l(e,t){return Object(n["a"])({url:"/task/refuse/"+e,method:"post",params:{remarks:t}})}function o(e,t){return Object(n["a"])({url:"/process/timeline/preview/"+e,method:"post",data:t})}function c(e){return Object(n["a"])({url:"/process/timeline/"+e,method:"post"})}function d(e){return Object(n["a"])({url:"/task/detail/"+e,method:"get"})}function u(e){return Object(n["a"])({url:"/inst/detail/"+e,method:"get"})}function m(e){return Object(n["a"])({url:"/inst/mine/about",method:"get",params:e})}},9257:function(e,t,i){"use strict";i("bab7")},9451:function(e,t,i){"use strict";var n=function(){var e=this,t=e._self._c;return t("el-timeline",{staticStyle:{"margin-top":"10px"},attrs:{reverse:!1}},[e.activities.length<=0?t("div",{staticStyle:{"padding-left":"10px",color:"#909399"}},[t("p",[e._v("填写表单以预览时间线")]),t("el-skeleton",{staticStyle:{width:"480px"},attrs:{rows:6,animated:""}})],1):e._e(),e._l(e.activities,(function(i,n){return t("el-timeline-item",{key:i.activityKey,attrs:{type:e.timeLineType(i),size:"large",timestamp:i.createDate,placement:"top"}},[i.tasks?t("el-card",{attrs:{shadow:"never"}},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v(e._s(i.activityName))]),t("span",{staticStyle:{font:"12px Extra Small",color:"#909399","margin-left":"10px"}},[e._v(e._s(i.description||""))])]),t("div",e._l(i.tasks,(function(i){return t("div",{staticStyle:{display:"inline-block","margin-left":"10px"}},[t("div",{staticStyle:{display:"inline-block"}},[t("el-avatar",{staticStyle:{background:"#409EFF"}},[e._v(e._s(i.finishUser||i.taskOwner||i.assignee))])],1),t("div",{staticStyle:{display:"inline-block","min-height":"60px","vertical-align":"middle","margin-left":"10px"}},[t("div",[e._v(e._s(i.finishUserName||i.taskOwner||i.assignee||"候选人"))]),i.finishDate?t("div",{staticStyle:{color:"#67C23A","font-size":"14px","line-height":"20px"}},[e._v(e._s(i.finishDate))]):t("div",{staticStyle:{color:"#E6A23C","font-size":"14px","line-height":"20px"}},[e._v(e._s("审批中"))])])])})),0)]):e._e(),i.tasks?e._e():t("el-card",{attrs:{shadow:"never"}},[t("span",[e._v(e._s(i.activityName))]),t("span",{staticStyle:{font:"12px Extra Small",color:"#909399","margin-left":"10px"}},[e._v(e._s(i.description||""))])])],1)}))],2)},a=[],s=i("644f"),r={name:"TimeLine",components:{},props:{current:{default:"root"}},data(){return{loading:!1,activities:[]}},mounted(){},computed:{},methods:{getActivities(){return this.activities},timestamp(e){return e.activityKey===this.current?e.createDate:""},timeLineType(e){return e.activityKey===this.current?"warning":e.finishDate?"success":"primary"},fresh(e,t){this.loading=!0,this.activities=[],Object(s["i"])(e,t).then(e=>{this.loading=!1,this.activities=e.data})},freshForInst(e){this.loading=!0,this.activities=[],Object(s["h"])(e).then(e=>{this.loading=!1,this.activities=e.data})}}},l=r,o=(i("1f4e"),i("2877")),c=Object(o["a"])(l,n,a,!1,null,"1fbbe75f",null);t["a"]=c.exports},b78d:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{padding:"10px 20px"}},[e.loading?e._e():t("div",[t("p",{staticStyle:{font:"14px Base",color:"#909399"}},[e._v(e._s(e.taskDetail.instCreatorName+" 发布于 "+e.taskDetail.instCreateDate))]),t("form-render",{ref:"form",staticClass:"process-form",attrs:{mode:"PC",formDisable:e.formDisable,forms:e.taskDetail.formItems},on:{input:e.valChange},model:{value:e.taskDetail.formData,callback:function(t){e.$set(e.taskDetail,"formData",t)},expression:"taskDetail.formData"}})],1),t("div",{staticStyle:{"padding-bottom":"10px"},on:{click:function(t){e.showTimeLine=!e.showTimeLine}}},[t("el-button",{staticStyle:{color:"#909399"},attrs:{type:"text",size:"medium"}},[e._v(" 审批流程 "),t("i",{class:{"el-icon-arrow-down":!e.showTimeLine,"el-icon-arrow-up":e.showTimeLine}})])],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showTimeLine,expression:"showTimeLine"}]},[t("timeLine",{ref:"timeLine",attrs:{current:e.taskDetail.activityKey}})],1)])},a=[],s=i("2b36"),r=i("d16b"),l=i("644f"),o=i("9451"),c=(i("3786"),{name:"InitiateProcess",components:{FormDesignRender:r["a"],FormRender:s["a"],TimeLine:o["a"]},props:{instId:{type:String,required:!1},taskId:{type:String,required:!1},mode:{type:String,default:"view"}},data(){return{myInstId:null,loading:!1,formDisable:!0,taskDetail:{formItems:[],formData:{}},showTimeLine:!1,count:0}},mounted(){this.loading=!0,this.formDisable=!0,this.myInstId=this.instId,this.taskId?this.loadByTaskId(this.taskId):this.myInstId&&this.loadByInstId(this.myInstId)},computed:{},methods:{loadByTaskId(e){this.loading=!0,Object(l["d"])(e).then(e=>{this.loading=!1,this.taskDetail=e.data||{},this.myInstId=e.data.processInstId}).then(()=>{this.$refs.timeLine.freshForInst(this.myInstId)}).finally(()=>this.loading=!1)},loadByInstId(e){this.loading=!0,Object(l["b"])(e).then(e=>{this.loading=!1,this.taskDetail=e.data||{}}).then(()=>{this.$refs.timeLine.freshForInst(this.myInstId)}).finally(()=>this.loading=!1)},validate(e){this.$refs.form.validate(e)},getFormData(){return this.taskDetail.formData},valChange(e){console.log(e)}}}),d=c,u=(i("f4e9"),i("2877")),m=Object(u["a"])(d,n,a,!1,null,"5213c0dc",null);t["default"]=m.exports},bab7:function(e,t,i){},d16b:function(e,t,i){"use strict";var n=function(){var e=this,t=e._self._c;return t(e.config.name,e._b({ref:"form",tag:"component",attrs:{mode:e.mode,formDisable:e.formDisable},on:{change:e.change},model:{value:e._value,callback:function(t){e._value=t},expression:"_value"}},"component",e.config.props,!1))},a=[];let s=()=>i.e("chunk-26c5db12").then(i.bind(null,"b28d")),r=()=>i.e("chunk-76d1ec8f").then(i.bind(null,"cf45")),l=()=>i.e("chunk-5f45dc72").then(i.bind(null,"5cb6")),o=()=>i.e("chunk-790652fa").then(i.bind(null,"d158")),c=()=>i.e("chunk-8b173cd0").then(i.bind(null,"0d29")),d=()=>i.e("chunk-c0be42b4").then(i.bind(null,"412b")),u=()=>i.e("chunk-4684e5ce").then(i.bind(null,"f89a")),m=()=>Promise.all([i.e("chunk-632f0cb0"),i.e("chunk-3c5bfb4f")]).then(i.bind(null,"4f98")),f=()=>i.e("chunk-ff757d9a").then(i.bind(null,"77aa")),h=()=>i.e("chunk-63081f7a").then(i.bind(null,"db9e")),p=()=>Promise.all([i.e("chunk-632f0cb0"),i.e("chunk-1b91adc2")]).then(i.bind(null,"023d")),b=()=>i.e("chunk-2d0f04df").then(i.bind(null,"9c98")),v=()=>i.e("chunk-2d0e4c53").then(i.bind(null,"9248")),g=()=>Promise.all([i.e("chunk-632f0cb0"),i.e("chunk-0c788674")]).then(i.bind(null,"f13b")),k=()=>Promise.all([i.e("chunk-632f0cb0"),i.e("chunk-4d4659b4")]).then(i.bind(null,"86c3")),y=()=>Promise.all([i.e("chunk-632f0cb0"),i.e("chunk-4dd0600d")]).then(i.bind(null,"6ea6")),_=()=>i.e("chunk-2d0e9937").then(i.bind(null,"8db7")),D=()=>Promise.all([i.e("chunk-632f0cb0"),i.e("chunk-11c03a8b"),i.e("chunk-12aa92e6")]).then(i.bind(null,"918a")),I=()=>Promise.all([i.e("chunk-632f0cb0"),i.e("chunk-11c03a8b"),i.e("chunk-d69b4ae0")]).then(i.bind(null,"7ca0"));var x={TextInput:s,NumberInput:r,AmountInput:l,TextareaInput:o,SelectInput:c,MultipleSelect:d,DateTime:u,DateTimeRange:m,UserPicker:k,DeptPicker:g,RolePicker:y,Description:f,FileUpload:p,ImageUpload:h,MoneyInput:v,Location:b,SignPanel:_,SpanLayout:D,TableList:I},w={name:"FormRender",components:x,props:{mode:{type:String,default:"DESIGN"},formDisable:{type:Boolean,default:!1},value:{default:void 0},config:{type:Object,default:()=>({})}},computed:{_value:{get(){return this.value},set(e){this.$emit("input",e)}}},data(){return{}},methods:{validate(e){this.$refs.form.validate(e)},change(e){this.$emit("change",this.config.id,e)}}},S=w,L=i("2877"),O=Object(L["a"])(S,n,a,!1,null,"755de815",null);t["a"]=O.exports},f2cb:function(e,t,i){},f4e9:function(e,t,i){"use strict";i("fc71")},fc71:function(e,t,i){}}]);
//# sourceMappingURL=chunk-72637162.2283567d.js.map