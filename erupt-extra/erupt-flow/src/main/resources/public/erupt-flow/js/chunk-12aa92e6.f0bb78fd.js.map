{"version":3,"sources":["webpack:///./src/views/common/form/components/SpanLayout.vue?f291","webpack:///./src/views/common/form/ComponentMinxins.js","webpack:///./src/views/common/form/components/SpanLayout.vue","webpack:///src/views/common/form/components/SpanLayout.vue","webpack:///./src/views/common/form/components/SpanLayout.vue?3182","webpack:///./src/views/common/form/components/SpanLayout.vue?82f4"],"names":["props","mode","type","String","default","formDisable","Boolean","required","data","watch","_value","newValue","oldValue","this","$emit","computed","get","value","set","val","methods","_opValue","op","_opLabel","label","render","_vm","_c","_self","staticClass","attrs","_items","animation","chosenClass","sort","on","$event","drag","selectFormItem","_l","cp","id","key","style","getSelectedClass","stopPropagation","selectItem","_v","_e","_s","title","delItem","staticStyle","__items","rows","rsi","item","ri","length","name","model","callback","$$v","$set","expression","staticRenderFns","mixins","componentMinxins","components","draggable","FormDesignRender","items","Array","result","i","push","$store","state","nodeMap","select","formConfig","rules","form","formId","formName","logo","formItems","process","remark","index","$confirm","confirmButtonText","cancelButtonText","then","forEach","removeFormItemAbout","splice","node","groups","group","cids","remove","conditions","formPerms","removeByKey","component"],"mappings":"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","file":"js/chunk-12aa92e6.f0bb78fd.js","sourcesContent":["export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpanLayout.vue?vue&type=style&index=0&id=372b2a08&prod&lang=less&scoped=true&\"","//混入组件数据\nexport default{\n  props:{\n    mode:{\n      type: String,\n      default: 'DESIGN'\n    },\n    formDisable:{\n      type: Boolean,\n      default: false\n    },\n    required:{\n      type: Boolean,\n      default: false\n    },\n  },\n  data(){\n    return {}\n  },\n  watch: {\n    _value(newValue, oldValue) {\n      this.$emit(\"change\", newValue);\n    }\n  },\n  computed: {\n    _value: {\n      get() {\n        return this.value;\n      },\n      set(val) {\n        this.$emit(\"input\", val);\n      }\n    }\n  },\n  methods: {\n    _opValue(op) {\n      if(typeof(op)==='object') {\n        return op.value;\n      }else {\n        return op;\n      }\n    },\n    _opLabel(op) {\n      if(typeof(op)==='object') {\n        return op.label;\n      }else {\n        return op;\n      }\n    }\n  }\n}\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[(_vm.mode === 'DESIGN')?_c('div',[_c('draggable',{staticClass:\"l-drag-from\",attrs:{\"list\":_vm._items,\"group\":\"form\",\"options\":{animation: 300, chosenClass:'choose', sort:true}},on:{\"start\":function($event){_vm.drag = true; _vm.selectFormItem = null},\"end\":function($event){_vm.drag = false}}},_vm._l((_vm._items),function(cp,id){return _c('div',{key:id,staticClass:\"l-form-item\",style:(_vm.getSelectedClass(cp)),on:{\"click\":function($event){$event.stopPropagation();return _vm.selectItem(cp)}}},[_c('div',{staticClass:\"l-form-header\"},[_c('p',[(cp.props.required)?_c('span',[_vm._v(\"*\")]):_vm._e(),_vm._v(_vm._s(cp.title))]),_c('div',{staticClass:\"l-option\"},[_c('i',{staticClass:\"el-icon-close\",on:{\"click\":function($event){return _vm.delItem(id)}}})]),_c('form-design-render',{attrs:{\"config\":cp}})],1)])}),0),_c('div',{staticStyle:{\"color\":\"#c0bebe\",\"text-align\":\"center\",\"width\":\"90%\",\"padding\":\"5px\"}},[_vm._v(\"☝ 拖拽控件到布局容器内部\")])],1):_c('div',_vm._l((_vm.__items),function(rows,rsi){return _c('el-row',{key:rsi + '_rows',attrs:{\"gutter\":20}},_vm._l((rows),function(item,ri){return _c('el-col',{key:ri + '_row',attrs:{\"span\":24 / rows.length}},[(item.name !== 'SpanLayout' && item.name !== 'Description')?_c('el-form-item',{key:item.name + ri,attrs:{\"prop\":item.id,\"label\":item.title}},[_c('form-design-render',{attrs:{\"mode\":_vm.mode,\"config\":item},model:{value:(_vm._value[item.id]),callback:function ($$v) {_vm.$set(_vm._value, item.id, $$v)},expression:\"_value[item.id]\"}})],1):_c('form-design-render',{attrs:{\"mode\":_vm.mode,\"config\":item},model:{value:(_vm._value),callback:function ($$v) {_vm._value=$$v},expression:\"_value\"}})],1)}),1)}),1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <div v-if=\"mode === 'DESIGN'\">\n      <draggable class=\"l-drag-from\" :list=\"_items\" group=\"form\"\n                 :options=\"{animation: 300, chosenClass:'choose', sort:true}\"\n                 @start=\"drag = true; selectFormItem = null\" @end=\"drag = false\">\n        <div v-for=\"(cp, id) in _items\" :key=\"id\" class=\"l-form-item\" @click.stop=\"selectItem(cp)\"\n             :style=\"getSelectedClass(cp)\">\n          <div class=\"l-form-header\">\n            <p><span v-if=\"cp.props.required\">*</span>{{ cp.title }}</p>\n            <div class=\"l-option\">\n              <!--<i class=\"el-icon-copy-document\" @click=\"copy\"></i>-->\n              <i class=\"el-icon-close\" @click=\"delItem(id)\"></i>\n            </div>\n            <form-design-render :config=\"cp\"/>\n          </div>\n        </div>\n      </draggable>\n      <div style=\"color: #c0bebe;text-align: center; width: 90%; padding: 5px;\">☝ 拖拽控件到布局容器内部</div>\n    </div>\n    <div v-else>\n      <el-row :gutter=\"20\" v-for=\"(rows, rsi) in __items\" :key=\"rsi + '_rows'\">\n        <el-col :span=\"24 / rows.length\" v-for=\"(item, ri) in rows\" :key=\"ri + '_row'\">\n          <el-form-item v-if=\"item.name !== 'SpanLayout' && item.name !== 'Description'\" :prop=\"item.id\"\n                        :label=\"item.title\" :key=\"item.name + ri\">\n            <form-design-render v-model=\"_value[item.id]\" :mode=\"mode\" :config=\"item\"/>\n          </el-form-item>\n          <form-design-render v-else v-model=\"_value\" :mode=\"mode\" :config=\"item\"/>\n        </el-col>\n      </el-row>\n\n    </div>\n\n  </div>\n\n</template>\n\n<script>\nimport draggable from \"vuedraggable\";\nimport FormDesignRender from '@/views/admin/layout/form/FormDesignRender'\nimport componentMinxins from '../ComponentMinxins'\n\nexport default {\n  mixins: [componentMinxins],\n  name: \"SpanLayout\",\n  components: {draggable, FormDesignRender},\n  props: {\n    value:{\n      default: null\n    },\n    items: {\n      type: Array,\n      default: () => {\n        return []\n      }\n    }\n  },\n  computed: {\n    _items: {\n      get() {\n        return this.items;\n      },\n      set(val) {\n        this.items = val;\n      }\n    },\n    __items() {\n      let result = []\n      for (let i = 0; i < this.items.length; i++) {\n        if (i > 0 && i % 2 > 0) {\n          result.push([this.items[i - 1], this.items[i]])\n        }\n      }\n      if (result.length * 2 < this.items.length) {\n        result.push([this.items[this.items.length - 1]])\n      }\n      return result\n    },\n    selectFormItem: {\n      get() {\n        return this.$store.state.selectFormItem\n      },\n      set(val) {\n        this.$store.state.selectFormItem = val\n      },\n    },\n    nodeMap() {\n      return this.$store.state.nodeMap\n    }\n  },\n  data() {\n    return {\n      select: null,\n      drag: false,\n      formConfig: {\n        //数据字段\n        data: {},\n        //校验规则\n        rules: {}\n      },\n      form: {\n        formId: '',\n        formName: \"\",\n        logo: {},\n        formItems: [],\n        process: {},\n        remark: \"\"\n      }\n    }\n  },\n  methods: {\n    selectItem(cp) {\n      this.selectFormItem = cp\n    },\n    getSelectedClass(cp) {\n      return this.selectFormItem && this.selectFormItem.id === cp.id ?\n          'border-left: 4px solid #f56c6c' : ''\n    },\n    delItem(index) {\n      this.$confirm('删除组件将会连带删除包含该组件的条件以及相关设置，是否继续?', '提示', {\n        confirmButtonText: '确 定',\n        cancelButtonText: '取 消',\n        type: 'warning'\n      }).then(() => {\n        if (this._items[index].name === 'SpanLayout') {\n          //删除的是分栏则遍历删除分栏内所有子组件\n          this._items[index].props.items.forEach(item => {\n            this.removeFormItemAbout(item)\n          })\n          this._items[index].props.items.length = 0\n        } else {\n          this.removeFormItemAbout(this._items[index])\n        }\n        this._items.splice(index, 1)\n      })\n    },\n    async removeFormItemAbout(item) {\n      this.nodeMap.forEach(node => {\n        //搜寻条件，进行移除\n        if (node.type === 'CONDITION') {\n          node.props.groups.forEach(group => {\n            let i = group.cids.remove(item.id)\n            if (i > -1) {\n              //从子条件移除\n              group.conditions.splice(i, 1)\n            }\n          })\n        }\n        //搜寻权限，进行移除\n        if (node.type === 'ROOT' || node.type === 'APPROVAL' || node.type === 'CC') {\n          node.props.formPerms.removeByKey('id', item.id)\n        }\n      })\n    },\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n\n\n.choose {\n  border: 1px dashed @theme-primary !important;\n}\n\n.l-drag-from {\n  min-height: 50px;\n  background-color: rgb(245, 246, 246);\n\n  .l-form-item, li {\n    cursor: grab;\n    background: #ffffff;\n    padding: 10px;\n    border: 1px solid #ebecee;\n    margin: 5px 0;\n  }\n}\n\n.l-form-header {\n  font-size: small;\n  color: #818181;\n  text-align: left;\n  position: relative;\n  background-color: #fff;\n\n  p {\n    position: relative;\n    margin: 0 0 10px 0;\n\n    span {\n      position: absolute;\n      left: -8px;\n      top: 3px;\n      color: rgb(217, 0, 19);\n    }\n  }\n\n  .l-option {\n    position: absolute;\n    top: -10px;\n    right: -10px;\n\n    i {\n      font-size: large;\n      cursor: pointer;\n      color: #8c8c8c;\n      padding: 5px;\n\n      &:hover {\n        color: @theme-primary;\n      }\n    }\n  }\n}\n\n</style>\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpanLayout.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpanLayout.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SpanLayout.vue?vue&type=template&id=372b2a08&scoped=true&\"\nimport script from \"./SpanLayout.vue?vue&type=script&lang=js&\"\nexport * from \"./SpanLayout.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SpanLayout.vue?vue&type=style&index=0&id=372b2a08&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"372b2a08\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}