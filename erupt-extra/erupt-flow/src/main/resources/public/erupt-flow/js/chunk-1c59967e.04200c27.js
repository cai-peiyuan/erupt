(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1c59967e","chunk-72637162"],{"14d9":function(t,e,a){"use strict";var i=a("23e7"),s=a("7b0b"),n=a("07fa"),r=a("3a34"),o=a("3511"),l=a("d039"),c=l((function(){return 4294967297!==[].push.call({length:4294967296},1)})),d=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},u=c||!d();i({target:"Array",proto:!0,arity:1,forced:u},{push:function(t){var e=s(this),a=n(e),i=arguments.length;o(a+i);for(var l=0;l<i;l++)e[a]=arguments[l],a++;return r(e,a),a}})},"1f4e":function(t,e,a){"use strict";a("f2cb")},"2b36":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("el-form",{ref:"form",staticClass:"process-form",attrs:{"label-position":"top",rules:t.rules,model:t._value}},t._l(t.forms,(function(a,i){return"SpanLayout"!==a.name&&"Description"!==a.name?e("el-form-item",{key:a.name+i,attrs:{prop:a.id,label:a.title}},[e("form-design-render",{ref:"sub-item_"+a.id,refInFor:!0,attrs:{mode:t.mode,formDisable:t.formDisable,config:a},on:{change:t.change},model:{value:t._value[a.id],callback:function(e){t.$set(t._value,a.id,e)},expression:"_value[item.id]"}})],1):e("form-design-render",{ref:"span-layout",attrs:{mode:t.mode,formDisable:t.formDisable,config:a},model:{value:t._value,callback:function(e){t._value=e},expression:"_value"}})})),1)},s=[],n=a("d16b"),r={name:"FormRender",components:{FormDesignRender:n["a"]},props:{forms:{type:Array,default:()=>[]},value:{type:Object,default:()=>({})},mode:{type:String,default:"PC"},formDisable:{type:Boolean,default:!1}},data(){return{rules:{}}},created(){this.loadFormConfig(this.forms)},computed:{_value:{get(){return this.value},set(t){this.$emit("input",t)}}},watch:{},methods:{validate(t){let e=!0;this.$refs.form.validate(a=>{if(e=a,a)for(let t=0;t<this.forms.length;t++)if("TableList"===this.forms[t].name){let a=this.$refs["sub-item_"+this.forms[t].id];if(a&&Array.isArray(a)&&a.length>0&&(a[0].validate(t=>{e=t}),!e))break}t(e)})},loadFormConfig(t){t.forEach(t=>{"SpanLayout"===t.name?this.loadFormConfig(t.props.items):(this.$set(this._value,t.id,this.value[t.id]),t.props.required&&this.$set(this.rules,t.id,[{type:"Array"===t.valueType?"array":void 0,required:!0,message:"请填写"+t.title,trigger:"blur"}]))})},change(t,e){this.$emit("change",t,e)}}},o=r,l=(a("9257"),a("2877")),c=Object(l["a"])(o,i,s,!1,null,"4bde07c6",null);e["a"]=c.exports},3511:function(t,e){var a=TypeError,i=9007199254740991;t.exports=function(t){if(t>i)throw a("Maximum allowed index exceeded");return t}},"3a34":function(t,e,a){"use strict";var i=a("83ab"),s=a("e8b5"),n=TypeError,r=Object.getOwnPropertyDescriptor,o=i&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=o?function(t,e){if(s(t)&&!r(t,"length").writable)throw n("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}},4518:function(t,e,a){"use strict";a("81d4")},"4ba8":function(t,e,a){"use strict";a("9958")},"4e02":function(t,e,a){"use strict";a.d(e,"e",(function(){return s})),a.d(e,"f",(function(){return n})),a.d(e,"g",(function(){return r})),a.d(e,"h",(function(){return o})),a.d(e,"b",(function(){return l})),a.d(e,"m",(function(){return c})),a.d(e,"j",(function(){return d})),a.d(e,"k",(function(){return u})),a.d(e,"a",(function(){return m})),a.d(e,"d",(function(){return f})),a.d(e,"l",(function(){return p})),a.d(e,"i",(function(){return h})),a.d(e,"c",(function(){return g}));var i=a("0c6d");function s(t){return Object(i["a"])({url:"/admin/form/group",method:"get",params:t})}function n(t){return Object(i["a"])({url:"/process/groups",method:"get",params:t})}function r(t){return Object(i["a"])({url:"/admin/form/sort",method:"put",data:t})}function o(t){return Object(i["a"])({url:"/admin/form/group/sort",method:"put",data:t})}function l(t){return Object(i["a"])({url:"/admin/form/group",method:"post",params:{groupName:t}})}function c(t,e){return Object(i["a"])({url:"/admin/form/group/"+t,method:"put",data:e})}function d(t){return Object(i["a"])({url:"/admin/form/group/"+t,method:"delete"})}function u(t,e){return Object(i["a"])({url:"/admin/form/"+t,method:"put",data:e})}function m(t){return Object(i["a"])({url:"/admin/form",method:"post",data:t})}function f(t){return Object(i["a"])({url:"/admin/form/detail/"+t,method:"get"})}function p(t){return Object(i["a"])({url:"/admin/form/detail",method:"put",data:t})}function h(t){return Object(i["a"])({url:"/admin/form/"+t.formId,method:"delete",data:t})}function g(){return Object(i["a"])({url:"/forms",method:"get"})}},"5ab1":function(t,e,a){},"644f":function(t,e,a){"use strict";a.d(e,"g",(function(){return s})),a.d(e,"e",(function(){return n})),a.d(e,"a",(function(){return r})),a.d(e,"f",(function(){return o})),a.d(e,"i",(function(){return l})),a.d(e,"h",(function(){return c})),a.d(e,"d",(function(){return d})),a.d(e,"b",(function(){return u})),a.d(e,"c",(function(){return m}));var i=a("0c6d");function s(t,e){return Object(i["a"])({url:"/process/start/form/"+t,method:"post",data:e})}function n(t){return Object(i["a"])({url:"/task/mine",method:"get",params:t})}function r(t,e){return Object(i["a"])({url:"/task/complete/"+t,method:"post",params:{remarks:e}})}function o(t,e){return Object(i["a"])({url:"/task/refuse/"+t,method:"post",params:{remarks:e}})}function l(t,e){return Object(i["a"])({url:"/process/timeline/preview/"+t,method:"post",data:e})}function c(t){return Object(i["a"])({url:"/process/timeline/"+t,method:"post"})}function d(t){return Object(i["a"])({url:"/task/detail/"+t,method:"get"})}function u(t){return Object(i["a"])({url:"/inst/detail/"+t,method:"get"})}function m(t){return Object(i["a"])({url:"/inst/mine/about",method:"get",params:t})}},"7bc7":function(t,e,a){"use strict";a("d83a")},"81d4":function(t,e,a){},9257:function(t,e,a){"use strict";a("bab7")},9451:function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("el-timeline",{staticStyle:{"margin-top":"10px"},attrs:{reverse:!1}},[t.activities.length<=0?e("div",{staticStyle:{"padding-left":"10px",color:"#909399"}},[e("p",[t._v("填写表单以预览时间线")]),e("el-skeleton",{staticStyle:{width:"480px"},attrs:{rows:6,animated:""}})],1):t._e(),t._l(t.activities,(function(a,i){return e("el-timeline-item",{key:a.activityKey,attrs:{type:t.timeLineType(a),size:"large",timestamp:a.createDate,placement:"top"}},[a.tasks?e("el-card",{attrs:{shadow:"never"}},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",[t._v(t._s(a.activityName))]),e("span",{staticStyle:{font:"12px Extra Small",color:"#909399","margin-left":"10px"}},[t._v(t._s(a.description||""))])]),e("div",t._l(a.tasks,(function(a){return e("div",{staticStyle:{display:"inline-block","margin-left":"10px"}},[e("div",{staticStyle:{display:"inline-block"}},[e("el-avatar",{staticStyle:{background:"#409EFF"}},[t._v(t._s(a.finishUser||a.taskOwner||a.assignee))])],1),e("div",{staticStyle:{display:"inline-block","min-height":"60px","vertical-align":"middle","margin-left":"10px"}},[e("div",[t._v(t._s(a.finishUserName||a.taskOwner||a.assignee||"候选人"))]),a.finishDate?e("div",{staticStyle:{color:"#67C23A","font-size":"14px","line-height":"20px"}},[t._v(t._s(a.finishDate))]):e("div",{staticStyle:{color:"#E6A23C","font-size":"14px","line-height":"20px"}},[t._v(t._s("审批中"))])])])})),0)]):t._e(),a.tasks?t._e():e("el-card",{attrs:{shadow:"never"}},[e("span",[t._v(t._s(a.activityName))]),e("span",{staticStyle:{font:"12px Extra Small",color:"#909399","margin-left":"10px"}},[t._v(t._s(a.description||""))])])],1)}))],2)},s=[],n=a("644f"),r={name:"TimeLine",components:{},props:{current:{default:"root"}},data(){return{loading:!1,activities:[]}},mounted(){},computed:{},methods:{getActivities(){return this.activities},timestamp(t){return t.activityKey===this.current?t.createDate:""},timeLineType(t){return t.activityKey===this.current?"warning":t.finishDate?"success":"primary"},fresh(t,e){this.loading=!0,this.activities=[],Object(n["i"])(t,e).then(t=>{this.loading=!1,this.activities=t.data})},freshForInst(t){this.loading=!0,this.activities=[],Object(n["h"])(t).then(t=>{this.loading=!1,this.activities=t.data})}}},o=r,l=(a("1f4e"),a("2877")),c=Object(l["a"])(o,i,s,!1,null,"1fbbe75f",null);e["a"]=c.exports},9958:function(t,e,a){},b78d:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{padding:"10px 20px"}},[t.loading?t._e():e("div",[e("p",{staticStyle:{font:"14px Base",color:"#909399"}},[t._v(t._s(t.taskDetail.instCreatorName+" 发布于 "+t.taskDetail.instCreateDate))]),e("form-render",{ref:"form",staticClass:"process-form",attrs:{mode:"PC",formDisable:t.formDisable,forms:t.taskDetail.formItems},on:{input:t.valChange},model:{value:t.taskDetail.formData,callback:function(e){t.$set(t.taskDetail,"formData",e)},expression:"taskDetail.formData"}})],1),e("div",{staticStyle:{"padding-bottom":"10px"},on:{click:function(e){t.showTimeLine=!t.showTimeLine}}},[e("el-button",{staticStyle:{color:"#909399"},attrs:{type:"text",size:"medium"}},[t._v(" 审批流程 "),e("i",{class:{"el-icon-arrow-down":!t.showTimeLine,"el-icon-arrow-up":t.showTimeLine}})])],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showTimeLine,expression:"showTimeLine"}]},[e("timeLine",{ref:"timeLine",attrs:{current:t.taskDetail.activityKey}})],1)])},s=[],n=a("2b36"),r=a("d16b"),o=a("644f"),l=a("9451"),c=(a("3786"),{name:"InitiateProcess",components:{FormDesignRender:r["a"],FormRender:n["a"],TimeLine:l["a"]},props:{instId:{type:String,required:!1},taskId:{type:String,required:!1},mode:{type:String,default:"view"}},data(){return{myInstId:null,loading:!1,formDisable:!0,taskDetail:{formItems:[],formData:{}},showTimeLine:!1,count:0}},mounted(){this.loading=!0,this.formDisable=!0,this.myInstId=this.instId,this.taskId?this.loadByTaskId(this.taskId):this.myInstId&&this.loadByInstId(this.myInstId)},computed:{},methods:{loadByTaskId(t){this.loading=!0,Object(o["d"])(t).then(t=>{this.loading=!1,this.taskDetail=t.data||{},this.myInstId=t.data.processInstId}).then(()=>{this.$refs.timeLine.freshForInst(this.myInstId)}).finally(()=>this.loading=!1)},loadByInstId(t){this.loading=!0,Object(o["b"])(t).then(t=>{this.loading=!1,this.taskDetail=t.data||{}}).then(()=>{this.$refs.timeLine.freshForInst(this.myInstId)}).finally(()=>this.loading=!1)},validate(t){this.$refs.form.validate(t)},getFormData(){return this.taskDetail.formData},valChange(t){console.log(t)}}}),d=c,u=(a("f4e9"),a("2877")),m=Object(u["a"])(d,i,s,!1,null,"5213c0dc",null);e["default"]=m.exports},bab7:function(t,e,a){},d16b:function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e(t.config.name,t._b({ref:"form",tag:"component",attrs:{mode:t.mode,formDisable:t.formDisable},on:{change:t.change},model:{value:t._value,callback:function(e){t._value=e},expression:"_value"}},"component",t.config.props,!1))},s=[];let n=()=>a.e("chunk-26c5db12").then(a.bind(null,"b28d")),r=()=>a.e("chunk-76d1ec8f").then(a.bind(null,"cf45")),o=()=>a.e("chunk-5f45dc72").then(a.bind(null,"5cb6")),l=()=>a.e("chunk-790652fa").then(a.bind(null,"d158")),c=()=>a.e("chunk-8b173cd0").then(a.bind(null,"0d29")),d=()=>a.e("chunk-c0be42b4").then(a.bind(null,"412b")),u=()=>a.e("chunk-4684e5ce").then(a.bind(null,"f89a")),m=()=>Promise.all([a.e("chunk-632f0cb0"),a.e("chunk-3c5bfb4f")]).then(a.bind(null,"4f98")),f=()=>a.e("chunk-ff757d9a").then(a.bind(null,"77aa")),p=()=>a.e("chunk-63081f7a").then(a.bind(null,"db9e")),h=()=>Promise.all([a.e("chunk-632f0cb0"),a.e("chunk-1b91adc2")]).then(a.bind(null,"023d")),g=()=>a.e("chunk-2d0f04df").then(a.bind(null,"9c98")),b=()=>a.e("chunk-2d0e4c53").then(a.bind(null,"9248")),v=()=>Promise.all([a.e("chunk-632f0cb0"),a.e("chunk-0c788674")]).then(a.bind(null,"f13b")),y=()=>Promise.all([a.e("chunk-632f0cb0"),a.e("chunk-4d4659b4")]).then(a.bind(null,"86c3")),x=()=>Promise.all([a.e("chunk-632f0cb0"),a.e("chunk-4dd0600d")]).then(a.bind(null,"6ea6")),k=()=>a.e("chunk-2d0e9937").then(a.bind(null,"8db7")),_=()=>Promise.all([a.e("chunk-632f0cb0"),a.e("chunk-11c03a8b"),a.e("chunk-12aa92e6")]).then(a.bind(null,"918a")),D=()=>Promise.all([a.e("chunk-632f0cb0"),a.e("chunk-11c03a8b"),a.e("chunk-d69b4ae0")]).then(a.bind(null,"7ca0"));var I={TextInput:n,NumberInput:r,AmountInput:o,TextareaInput:l,SelectInput:c,MultipleSelect:d,DateTime:u,DateTimeRange:m,UserPicker:y,DeptPicker:v,RolePicker:x,Description:f,FileUpload:h,ImageUpload:p,MoneyInput:b,Location:g,SignPanel:k,SpanLayout:_,TableList:D},w={name:"FormRender",components:I,props:{mode:{type:String,default:"DESIGN"},formDisable:{type:Boolean,default:!1},value:{default:void 0},config:{type:Object,default:()=>({})}},computed:{_value:{get(){return this.value},set(t){this.$emit("input",t)}}},data(){return{}},methods:{validate(t){this.$refs.form.validate(t)},change(t){this.$emit("change",this.config.id,t)}}},C=w,S=a("2877"),T=Object(S["a"])(C,i,s,!1,null,"755de815",null);e["a"]=T.exports},d43f:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"workspace"},[e("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":t.changeTab},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:"发起工单",name:"tab1"}},[e("el-row",{staticStyle:{"margin-bottom":"20px"}},[e("el-col",{attrs:{xs:12,sm:10,md:8,lg:6,xl:4}},[e("el-input",{attrs:{size:"medium",placeholder:"搜索表单",clearable:""},model:{value:t.formList.inputs,callback:function(e){t.$set(t.formList,"inputs",e)},expression:"formList.inputs"}},[e("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1)],1),e("el-collapse",{model:{value:t.actives,callback:function(e){t.actives=e},expression:"actives"}},t._l(t.formList.list,(function(a,i){return e("el-collapse-item",{directives:[{name:"show",rawName:"v-show",value:a.groupId>=0&&a.processDefs.length>0,expression:"group.groupId >= 0 && group.processDefs.length > 0"}],key:i,attrs:{title:a.groupName,name:a.groupName}},t._l(a.processDefs,(function(a,i){return e("div",{key:i,staticClass:"form-item",on:{click:function(e){return t.enterItem(a)}}},[e("i",{class:a.logo.icon,style:"background: "+a.logo.background}),e("div",[e("ellipsis",{attrs:{"hover-tip":"",content:a.formName}}),e("span",[t._v("发起审批")])],1)])})),0)})),1)],1),e("el-tab-pane",{attrs:{label:"待我处理("+(t.myTaskCount||0)+")",name:"tab2"}},[e("MyTask",{ref:"myTask",on:{afterLoad:t.setMyTaskCount}})],1),e("el-tab-pane",{attrs:{label:"我的工单",name:"tab3"}},[e("me-about",{ref:"meAbout"})],1)],1),e("el-dialog",{attrs:{title:t.formTitle,width:"800px",top:"20px",visible:t.openItemDl,"close-on-click-modal":!1},on:{"update:visible":function(e){t.openItemDl=e}}},[t.openItemDl?e("initiate-process",{ref:"processForm",attrs:{code:t.selectForm.id}}):t._e(),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.openItemDl=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("提 交")])],1)],1)],1)},s=[],n=(a("14d9"),a("4e02")),r=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[t.loading?t._e():e("div",[e("form-render",{ref:"form",staticClass:"process-form",attrs:{forms:t.forms},on:{change:t.formChange},model:{value:t.formData,callback:function(e){t.formData=e},expression:"formData"}})],1),e("div",{staticStyle:{"padding-bottom":"10px"},on:{click:function(e){t.showTimeLine=!t.showTimeLine}}},[e("el-button",{staticStyle:{color:"#909399"},attrs:{type:"text",size:"medium"}},[t._v(" 审批流程 "),e("i",{class:{"el-icon-arrow-down":!t.showTimeLine,"el-icon-arrow-up":t.showTimeLine}})])],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showTimeLine,expression:"showTimeLine"}]},[e("timeLine",{ref:"timeLine",attrs:{current:"root"}})],1)])},o=[],l=a("2b36"),c=a("d16b"),d=a("9451"),u={name:"InitiateProcess",components:{FormDesignRender:c["a"],FormRender:l["a"],TimeLine:d["a"]},props:{code:{type:String,required:!0}},data(){return{loading:!1,formData:{},showTimeLine:!1,form:{formId:"",formName:"",logo:{},formItems:[],process:{},remark:""}}},mounted(){this.loadFormInfo(this.code)},computed:{forms(){return this.$store.state.design.formItems}},watch:{},methods:{loadFormInfo(t){this.loading=!0,Object(n["d"])(t).then(t=>{this.loading=!1;let e=t.data;e.logo=JSON.parse(e.logo),e.settings=JSON.parse(e.settings),e.formItems=JSON.parse(e.formItems),e.process=JSON.parse(e.process),this.form=e,this.$store.state.design=e}).catch(t=>{this.loading=!1,this.$message.error(t)})},validate(t){this.$refs.form.validate(t)},formChange(t,e){this.$nextTick(()=>{(this.$refs.timeLine.getActivities().length<=0||this.isConditionField(t,this.form.process))&&this.$refs.timeLine.fresh(this.code,this.formData)})},isConditionField(t,e){if("CONDITION"==e.type&&e.props.groups&&e.props.groups.length>0)for(let a in e.props.groups)for(let i in e.props.groups[a].conditions)if(e.props.groups[a].conditions[i].id===t)return!0;if(e.branchs&&e.branchs.length>0)for(let a in e.branchs)if(this.isConditionField(t,e.branchs[a]))return!0;return!(!e.children||!this.isConditionField(t,e.children))}}},m=u,f=(a("f74a"),a("2877")),p=Object(f["a"])(m,r,o,!1,null,"8acd8b4a",null),h=p.exports,g=a("644f"),b=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"myTask"},[e("el-row",{staticStyle:{"margin-bottom":"20px"}},[e("el-col",{attrs:{xs:12,sm:10,md:8,lg:6,xl:4}},[e("el-input",{attrs:{size:"medium",placeholder:"搜索待我审批的工单",clearable:""},model:{value:t.queryParam.keywords,callback:function(e){t.$set(t.queryParam,"keywords",e)},expression:"queryParam.keywords"}})],1),e("el-col",{staticStyle:{"padding-left":"10px"},attrs:{xs:12,sm:10,md:8,lg:6,xl:4}},[e("el-button",{attrs:{icon:"el-icon-search",round:""},on:{click:t.reloadDatas}},[t._v("搜索")])],1)],1),e("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadDatas,expression:"loadDatas"}],staticClass:"infinite-list-wrapper taskPanel",attrs:{"infinite-scroll-disabled":"disabled"}},[t._l(t.dataList,(function(a,i){return e("li",[e("el-card",{staticClass:"taskCard",attrs:{shadow:"hover"}},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("el-link",{staticStyle:{font:"18px large"},attrs:{underline:!1},on:{click:function(e){return t.showDetail(a)}}},[t._v(t._s(a.taskName))]),e("span",{staticStyle:{font:"12px Extra Small",color:"#909399","padding-left":"20px"}},[t._v(" "+t._s(a.createDate))]),e("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(e){return t.showDetail(a)}}},[t._v("详情")])],1),e("div",{staticClass:"text item"},[e("el-row",[e("el-col",{attrs:{xs:6,sm:6,md:6,lg:6,xl:4}},[e("i",{staticClass:"el-icon-eleme ic avator",staticStyle:{background:"rgb(30, 144, 255)"}}),e("span",{staticClass:"taskCell",staticStyle:{color:"#909399"}},[t._v(t._s(a.formName))])]),e("el-col",{attrs:{xs:6,sm:6,md:6,lg:6,xl:4}},[e("span",{staticClass:"taskCell",staticStyle:{color:"#909399"}},[t._v(t._s(a.businessTitle))])]),e("el-col",{attrs:{xs:12,sm:12,md:12,lg:12,xl:8}},[e("span",{staticClass:"taskCell",staticStyle:{color:"#909399"}},[t._v(t._s(a.instCreatorName+" 发起于 "+a.instCreateDate))])])],1)],1)])],1)})),t.loading?e("div",{staticStyle:{"text-align":"center",color:"#C0C4CC",padding:"10px","min-width":"30px","min-height":"50px"}},[t._v("加载中...")]):t._e(),t.noMore?e("div",{staticStyle:{"text-align":"center",color:"#C0C4CC",padding:"10px","min-width":"30px","min-height":"50px"}},[t._v("没有更多了~")]):t._e()],2),e("el-dialog",{attrs:{title:t.selectInst.businessTitle,width:"800px",top:"20px",visible:t.openItemDl,"close-on-click-modal":!1},on:{"update:visible":function(e){t.openItemDl=e}}},[t.openItemDl?e("TaskDetail",{ref:"taskDetail",attrs:{"task-id":t.selectInst.id,mode:"audit"},on:{"update:taskId":function(e){return t.$set(t.selectInst,"id",e)},"update:task-id":function(e){return t.$set(t.selectInst,"id",e)}}}):t._e(),e("span",{staticClass:"dialog-footer",staticStyle:{"padding-right":"20px"},attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.openItemDl=!1}}},[t._v("关 闭")]),e("el-button",{attrs:{type:"danger"},on:{click:function(e){return t.refuse(t.selectInst.id)}}},[t._v("拒 绝")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.complete(t.selectInst.id)}}},[t._v("同 意")])],1)],1)],1)},v=[],y=a("b78d"),x={name:"MyTask",components:{TaskDetail:y["default"]},props:{},data(){return{selectInst:{},openItemDl:!1,loading:!1,queryParam:{keywords:"",pageSize:10,pageIndex:1},dataList:[],count:0,maxCount:0}},mounted(){this.reloadDatas()},computed:{noMore(){return this.count>=this.maxCount},disabled(){return this.loading||this.noMore}},methods:{reloadDatas(){this.reset(),this.loadDatas()},reset(){this.loading=!0,this.queryParam={pageSize:10,pageIndex:1},this.dataList=[],this.count=0,this.maxCount=0},loadDatas(){this.loading=!0,Object(g["e"])(this.queryParam).then(t=>{this.loading=!1,t.data.list.map(t=>{this.dataList.push(t),this.count+=1}),this.queryParam.pageIndex++,this.maxCount=t.data.total,this.$emit("afterLoad",this.maxCount,this.dataList)}).finally(()=>{this.loading=!1})},showDetail(t){this.selectInst=t,this.openItemDl=!0},complete(t){this.$prompt("","审批通过",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(e=>{Object(g["a"])(t,e.value).then(t=>{this.$message.success(t.message),this.openItemDl=!1,this.reloadDatas()})})},refuse(t){this.$prompt("请输入拒绝意见","您正在驳回审批",{type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(e=>{Object(g["f"])(t,e.value).then(t=>{this.$message.success(t.message),this.openItemDl=!1,this.reloadDatas()})})}}},k=x,_=(a("4ba8"),Object(f["a"])(k,b,v,!1,null,"3972477d",null)),D=_.exports,I=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"meAbout"},[e("el-row",{staticStyle:{"margin-bottom":"20px"}},[e("el-col",{attrs:{xs:12,sm:10,md:8,lg:6,xl:4}},[e("el-input",{attrs:{size:"medium",placeholder:"搜索我发起的、我审批的、抄送我的工单",clearable:""},model:{value:t.queryParam.keywords,callback:function(e){t.$set(t.queryParam,"keywords",e)},expression:"queryParam.keywords"}})],1),e("el-col",{staticStyle:{"padding-left":"10px"},attrs:{xs:12,sm:10,md:8,lg:6,xl:4}},[e("el-button",{attrs:{icon:"el-icon-search",round:""},on:{click:t.reloadDatas}},[t._v("搜索")])],1)],1),e("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadDatas,expression:"loadDatas"}],staticClass:"infinite-list-wrapper taskPanel",attrs:{"infinite-scroll-disabled":"disabled"}},[t._l(t.dataList,(function(a){return e("li",[e("el-card",{staticClass:"taskCard",attrs:{shadow:"hover"}},[e("div",{staticClass:"clearfix",staticStyle:{"padding-left":"10px"},attrs:{slot:"header"},slot:"header"},[a.tag?e("div",{class:{angle_mark:!0,angle_mark_color1:"发起"===a.tag,angle_mark_color2:"审批"===a.tag,angle_mark_color3:"抄送"===a.tag}},[e("span",[t._v(t._s(a.tag))])]):t._e(),e("el-row",[e("el-col",{attrs:{xs:20,sm:8,md:8,lg:6,xl:4}},[e("el-link",{staticStyle:{font:"18px large"},attrs:{underline:!1},on:{click:function(e){return t.showDetail(a)}}},[t._v(t._s(a.businessTitle))])],1),e("el-col",{attrs:{xs:4,sm:8,md:8,lg:6,xl:8}},[e("el-tag",{staticStyle:{"margin-left":"10px"},attrs:{type:t.getStatus(a).type}},[t._v(" "+t._s(t.getStatus(a).text)+" ")]),"FINISHED"===a.status||"SHUTDOWN"===a.status?e("span",{staticStyle:{color:"#909399"}},[t._v(" "+t._s("结束于 "+a.finishDate)+" ")]):t._e()],1),e("el-col",{attrs:{xs:0,sm:8,md:8,lg:12,xl:12}},[e("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(e){return t.showDetail(a)}}},[t._v("详情")])],1)],1)],1),e("div",{staticClass:"text item",staticStyle:{"padding-left":"10px"}},[e("el-row",[e("el-col",{attrs:{xs:6,sm:6,md:6,lg:6,xl:4}},[e("i",{staticClass:"el-icon-eleme ic avator"}),e("span",{staticClass:"taskCell",staticStyle:{color:"#909399"}},[t._v(t._s(a.formName))])]),e("el-col",{attrs:{xs:18,sm:18,md:18,lg:18,xl:20}},[e("span",{staticClass:"taskCell",staticStyle:{color:"#909399"}},[t._v(t._s(a.creatorName+" 发起于 "+a.createDate))])])],1)],1)])],1)})),t.loading?e("div",{staticStyle:{"text-align":"center",color:"#C0C4CC",padding:"10px","min-width":"30px","min-height":"50px"}},[t._v("加载中...")]):t._e(),t.noMore?e("div",{staticStyle:{"text-align":"center",color:"#C0C4CC",padding:"10px","min-width":"30px","min-height":"50px"}},[t._v("没有更多了~")]):t._e()],2),e("el-dialog",{attrs:{title:t.selectInst.businessTitle,width:"800px",top:"20px",visible:t.openItemDl,"close-on-click-modal":!1},on:{"update:visible":function(e){t.openItemDl=e}}},[t.openItemDl?e("TaskDetail",{ref:"taskDetail",attrs:{"inst-id":t.selectInst.id},on:{"update:instId":function(e){return t.$set(t.selectInst,"id",e)},"update:inst-id":function(e){return t.$set(t.selectInst,"id",e)}}}):t._e(),e("span",{staticClass:"dialog-footer",staticStyle:{"padding-right":"20px"},attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.openItemDl=!1}}},[t._v("关 闭")])],1)],1)],1)},w=[],C={name:"MeAbout",components:{TaskDetail:y["default"]},props:{},data(){return{selectInst:{},openItemDl:!1,loading:!1,queryParam:{keywords:"",pageSize:10,pageIndex:1},dataList:[],count:0,maxCount:0}},mounted(){this.reloadDatas()},computed:{noMore(){return this.count>=this.maxCount},disabled(){return this.loading||this.noMore}},methods:{reloadDatas(){this.reset(),this.loadDatas()},getStatus(t){return"RUNNING"===t.status?{text:"审批中",type:"primary"}:"PAUSE"===t.status?{text:"暂停",type:"warning"}:"FINISHED"===t.status?{text:"已完成",type:"success"}:"SHUTDOWN"===t.status?{text:"已拒绝",type:"danger"}:void 0},reset(){this.loading=!0,this.queryParam={pageSize:10,pageIndex:1},this.dataList=[],this.count=0,this.maxCount=0},loadDatas(){this.loading=!0,Object(g["c"])(this.queryParam).then(t=>{this.loading=!1,t.data.list.map(t=>{this.dataList.push(t),this.count+=1}),this.queryParam.pageIndex++,this.maxCount=t.data.total,this.$emit("afterLoad",this.maxCount,this.dataList)}).finally(()=>{this.loading=!1})},showDetail(t){this.selectInst=t,this.openItemDl=!0}}},S=C,T=(a("7bc7"),Object(f["a"])(S,I,w,!1,null,"596cbf27",null)),O=T.exports,L={name:"workSpace",components:{InitiateProcess:h,MyTask:D,MeAbout:O},data(){return{dataList:[],loading:!1,openItemDl:!1,formTitle:"",activeName:"tab1",selectForm:{},formItem:{},actives:[],formList:{list:[],inputs:"",searchResult:[]},pending:{list:[]},myTaskCount:0}},mounted(){this.getGroups()},methods:{getGroups(){Object(n["f"])({keywords:this.formList.inputs}).then(t=>{this.formList.list=t.data,this.formList.list.forEach(t=>{this.actives.push(t.groupName),t.processDefs.forEach(t=>{t.logo=JSON.parse(t.logo)})}),this.groups=t.data})},enterItem(t){this.formTitle=t.formName,this.selectForm=t,this.openItemDl=!0},submitForm(){this.$refs.processForm.validate(t=>{t?Object(g["g"])(this.selectForm.id,this.$refs.processForm.formData).then(t=>{this.$message.success(t.message),this.openItemDl=!1,this.$refs.myTask.reloadDatas(),this.$refs.meAbout.reloadDatas()}):this.$message.warning("请完善表单😥")})},setMyTaskCount(t){this.myTaskCount=t},changeTab(t){return this.$refs.myTask.reloadDatas(),this.$refs.meAbout.reloadDatas(),!0}}},j=L,N=(a("4518"),Object(f["a"])(j,i,s,!1,null,"7bea5c94",null));e["default"]=N.exports},d83a:function(t,e,a){},e8b5:function(t,e,a){var i=a("c6b6");t.exports=Array.isArray||function(t){return"Array"==i(t)}},f2cb:function(t,e,a){},f4e9:function(t,e,a){"use strict";a("fc71")},f74a:function(t,e,a){"use strict";a("5ab1")},fc71:function(t,e,a){}}]);
//# sourceMappingURL=chunk-1c59967e.04200c27.js.map